@import "tailwindcss";

/* ---------- Base brand palette (light) ---------- */
:root {
  --brand-50:  #eff6ff;
  --brand-100: #dbeafe;
  --brand-200: #bfdbfe;
  --brand-400: #4a6ac3;
  --brand-600: #2563eb;
  --brand-700: #1d4ed8;
  --brand-800: #1e2b4f;

  /* surface gradient for light */
  --surface-start: #f0f9ff;
  --surface-end:   #ffffff;
}

/* Tailwind v4 inline theme tokens (keep) */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

/* ---------- Legacy background/foreground (kept for safety) ---------- */
:root {
  --background: #ffffff;
  --foreground: #171717;
}
@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

/* =================================================================== */
/*                         THEME TOKENS (NEW)                           */
/* =================================================================== */
:root {
  /* Light defaults */
  --bg:     #f7f7fb;
  --fg:     #111827;
  --card:   #ffffff;
  --muted:  #6b7280;
  --border: #e5e7eb;
  --accent: #2563eb;
  --sidebar-hover: var(--brand-100);
  color-scheme: light;
}

:root[data-theme="dark"] {
  /* Dark with brighter text & borders for readability */
  --bg:     #0b0f17;       /* page background */
  --card:   #0f1623;       /* panels/cards */
  --fg:     #f7f0ee;       /* main text (brighter) */
  --muted:  #c7d2e0;       /* secondary text */
  --border: #2a3446;       /* divider/border */
  --accent: #2f4fc4;       /* keep blue a bit brighter */
  --sidebar-hover: #0e1624;
  color-scheme: dark;
}

/* =================================================================== */
/*                               BASE                                   */
/* =================================================================== */
html, body {
  background: var(--bg);
  color: var(--fg);
  font-family: Arial, Helvetica, sans-serif;
}
html { scrollbar-gutter: stable both-edges; }

/* Light surface gradient; in dark we flatten to --bg */
.page-bg {
  @apply min-h-screen;
  background-image: linear-gradient(to bottom, var(--surface-start), white, var(--surface-end));
}
:root[data-theme="dark"] .page-bg { background: var(--bg); background-image: none; }

/* Smooth theme transitions */
* { transition: background-color .15s ease, color .15s ease, border-color .15s ease, box-shadow .15s ease; }

/* =================================================================== */
/*                           UI PRIMITIVES                              */
/* =================================================================== */
.btn {
  @apply inline-flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-medium transition-colors;
  color: var(--fg);
}
.btn-primary { @apply text-white; background-color: var(--accent); }
.btn-primary:hover { filter: brightness(0.95); }
.btn-outline  { @apply border; border-color: var(--border); }
.btn-outline:hover { background-color: rgba(37, 99, 235, 0.08); } /* blue-600 @ 8% */

/* Chips / badges */
.badge-primary { @apply px-3 py-2 text-xs rounded-lg shadow; background-color: var(--brand-800); color: #fff; }

/* Links */
.link-accent { @apply underline underline-offset-2; color: var(--brand-700); }
.link-accent:hover { color: var(--brand-600); }

/* Progress */
.progress-track { @apply h-2 rounded-full bg-zinc-200; }
.progress-fill  { @apply h-full rounded-full; background-color: var(--accent); }

/* Cards */
.card { @apply rounded-xl border shadow-sm; background: var(--card); border-color: var(--border); }

/* Brand helpers */
.text-brand  { color: var(--brand-700); }
.bg-brand-100{ background: var(--brand-100); }

/* Sections */
.section { padding-top: 2.25rem; padding-bottom: 2.25rem; }
@media (min-width: 1024px) { .section { padding-top: 3rem; padding-bottom: 3rem; } }

/* Nice gradient helper */
.brand-gradient { background-image: linear-gradient(to right, var(--brand-600), var(--brand-700)); }

/* Chips */
.chip {
  @apply inline-flex items-center rounded-full border px-2.5 py-1 text-xs;
  border-color: var(--border);
  background-color: rgba(255,255,255,.7);
  backdrop-filter: blur(2px);
}
:root[data-theme="dark"] .chip { background-color: rgba(255,255,255,.06); }
:root[data-theme="dark"] .btn-outline:hover { background-color: #ffffff24; }

/* =================================================================== */
/*                 DARK MODE OVERRIDES FOR COMMON CLASSES              */
/* =================================================================== */

/* Panels & translucent header */
:root[data-theme="dark"] .bg-white     { background-color: var(--card) !important; }
:root[data-theme="dark"] .bg-white\/70 { background-color: rgba(15,22,35,.7) !important; }

/* Borders */
:root[data-theme="dark"] .border-zinc-200,
:root[data-theme="dark"] .border-zinc-300 { border-color: var(--border) !important; }

/* Sidebar: use dedicated border token */
.sidebar-nav .border,
.sidebar-nav a { border-color: var(--sidebar-border) !important; }
/* Sidebar hover */
.sidebar-nav a:not([aria-current="page"]):hover {
  background-color: var(--sidebar-hover) !important;
}


/* Active state — тоже на sidebar token */
.sidebar-nav a[aria-current="page"],
.sidebar-nav [data-active="true"] {
  border-color: var(--sidebar-border) !important;
}

/* Text tone mapping */
:root[data-theme="dark"] .text-zinc-700 { color: var(--fg)    !important; }
:root[data-theme="dark"] .text-zinc-600,
:root[data-theme="dark"] .text-zinc-500,
:root[data-theme="dark"] .text-zinc-400 { color: var(--muted) !important; }

/* Opacity utilities are too dim on dark; lift them a bit */
:root[data-theme="dark"] .opacity-70 { opacity: .90 !important; }
:root[data-theme="dark"] .opacity-60 { opacity: .86 !important; }
:root[data-theme="dark"] .opacity-50 { opacity: .82 !important; }

/* Neutral hover tint still visible on dark */
:root[data-theme="dark"] .hover\:bg-zinc-100:hover { background-color: #ffffff14 !important; }

/* Stronger shadow for separation in dark */
:root[data-theme="dark"] .shadow-lg {
  box-shadow: 0 8px 24px rgba(0,0,0,.5), 0 0 0 1px rgba(255,255,255,.02);
}

/* --- Tables in dark: fix light zebra rows & headers --- */
:root[data-theme="dark"] .bg-zinc-50 { background-color: #101a29 !important; }
:root[data-theme="dark"] .bg-zinc-100 { background-color: #0e1624 !important; }

/* If zebra utilities are used (odd:bg-... / even:bg-...) override them too */
:root[data-theme="dark"] .odd\:bg-zinc-50:nth-child(odd)  { background-color: #101a29 !important; }
:root[data-theme="dark"] .even\:bg-zinc-50:nth-child(even){ background-color: #101a29 !important; }
:root[data-theme="dark"] .odd\:bg-zinc-100:nth-child(odd) { background-color: #0e1624 !important; }
:root[data-theme="dark"] .even\:bg-zinc-100:nth-child(even){ background-color: #0e1624 !important; }

/* Make sure text stays readable on those rows */
:root[data-theme="dark"] .text-zinc-900,
:root[data-theme="dark"] .text-zinc-800 { color: var(--fg) !important; }

/* Divider inside tables a bit brighter */
:root[data-theme="dark"] .divide-zinc-200 > :not([hidden]) ~ :not([hidden]) {
  border-color: var(--border) !important;
}

/* Dark fix for white-border utility used in timer cards */
:root[data-theme="dark"] .border-white\/60 {
  border-color: var(--border) !important;
}

/* Hero decorative blobs (light & dark) */
.hero-blobs{
  --blob-a: var(--brand-200);
  --blob-b: var(--brand-100);
  background-image:
    radial-gradient(closest-side, color-mix(in srgb, var(--blob-a) 88%, transparent), transparent 80%),
    radial-gradient(closest-side, color-mix(in srgb, var(--blob-b) 88%, transparent), transparent 80%);
  background-position: right -6rem top -10rem, left -8rem bottom -7rem;
  background-size: 28rem 28rem, 32rem 32rem;
  background-repeat: no-repeat, no-repeat;
}
:root[data-theme="dark"] .hero-blobs{
  --blob-a: #0f2547; /* darker denim */
  --blob-b: #0b1b33; /* deep navy */
  opacity: .55;
}

/* --- Sidebar active (dark): выразительнее, но не слепит --- */
:root[data-theme="dark"] .sidebar-nav a[aria-current="page"],
:root[data-theme="dark"] .sidebar-nav [data-active="true"]{
  background: linear-gradient(180deg,#303b80 0%, #122034 100%) !important;
  border-color: #2a3446 !important;
  color: #fff0e6 !important; /* чуть светлее, не "disabled" */
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
}
/* hover для неактивных пунктов */
:root[data-theme="dark"] .sidebar-nav a:not([aria-current="page"]):hover{
  background-color:#0e1624 !important;
}

/* Brand helpers  */
:root[data-theme="dark"] .bg-brand-100   { background-color: #284782 !important; }
:root[data-theme="dark"] .text-brand     { color: #ffecd9 !important; }
:root[data-theme="dark"] .border-brand-200 { border-color: var(--border) !important; }

:root[data-theme="dark"] .sidebar-nav a[aria-current="page"],
:root[data-theme="dark"] .sidebar-nav [data-active="true"]{
  background-color:#23140f !important;
  border-color:#749ae2 !important;
  color:#ffd9d9 !important;
}
:root[data-theme="dark"] .sidebar-nav a:not([aria-current="page"]):hover{
  background-color:#1b2865 !important;
}

:root {
  /* ... */
  --border: #e5e7eb;
  --accent: #2563eb;

  /* NEW: sidebar-only border (light) */
  --sidebar-border: var(--border);
}

:root[data-theme="dark"] {
  /* ... */
  --border: #2a3446;
  --accent: #2f4fc4;

  /* NEW: sidebar-only border (dark) — можешь менять как угодно */
  --sidebar-border: #243049; /* поумереннее, чем общий --border */
}

/* Hide native password reveal/clear buttons (Edge/IE) */
input[type="password"]::-ms-reveal,
input[type="password"]::-ms-clear { display: none; }

/* Hide WebKit decorations that can overlap (Safari/Chrome) */
input[type="password"]::-webkit-textfield-decoration-container { display: none; }
input[type="password"]::-webkit-clear-button { display: none; }
input[type="password"]::-webkit-credentials-auto-fill-button { display: none; }
input[type="password"]::-webkit-contacts-auto-fill-button { display: none; }

/* =================================================================== */
/*                          FORM CONTROLS (NEW)                        */
/* =================================================================== */
.label {
  @apply block text-sm font-medium mb-1;
  color: var(--fg);
}
.form-help { @apply mt-1 text-xs block; color: var(--muted); }
.form-error { @apply mt-1 text-xs; color: #dc2626; } /* red-600 */

.input, .textarea {
  @apply w-full rounded-xl border px-3 py-2 text-sm outline-none;
  background: var(--card);
  color: var(--fg);
  border-color: var(--border);
}
.select {
  @apply rounded-xl border px-3 py-2 text-sm outline-none inline-flex items-center;
  background: var(--card);
  color: var(--fg);
  border-color: var(--border);
}

.textarea { @apply min-h-[92px] resize-y; }

.input::placeholder,
.textarea::placeholder { color: color-mix(in srgb, var(--muted) 82%, transparent); }

.input:focus, .select:focus, .textarea:focus {
  border-color: color-mix(in srgb, var(--accent) 70%, var(--border));
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 18%, transparent);
}

.input[disabled], .select[disabled], .textarea[disabled] {
  @apply cursor-not-allowed opacity-70;
  background: color-mix(in srgb, var(--card) 92%, transparent);
}

.input-error, .select-error, .textarea-error {
  border-color: #dc2626 !important;
  box-shadow: 0 0 0 3px color-mix(in srgb, #dc2626 18%, transparent) !important;
}

/* Native select normalize (keeps Tailwind utilities working) */
.select {
  appearance: none;
  background-image: none;
  background-position: right .75rem center;
  background-repeat: no-repeat;
  padding-right: .75rem; 
}

/* Placeholder tone for empty selects/buttons */
.select[data-empty="true"] { color: var(--muted); }
